---
title: 베이즈 정리(Bayes' theorem)
author: Monch
category: math
layout: post
---

[LIST로 가기](https://songminkee.github.io/math/2030/05/03/list.html)

<h2>베이즈 정리</h2>

조건부 확률의 응용이며 일종의 역문제를 생각한다. 역문제는 간단히 말해 결과에서 원인을 찾는 문제이다.  

원인 X를 직접적으로 관측, 측정할 수 없을 때 거기서 일어난 결과 Y를 보고 원인 X를 추측하는 것이다.  

여기서 $$P(원인)$$을 사전확률, P(원인|결과)를 사후확률이라고 한다. 베이즈 공식은 사후확률을 구하는 것이다.



<h4>ex1)</h4>

Q. 어떤 게임에서 몬스터를 쓰러뜨리면 보물 상자를 얻을 수 있다. 보물 상자는 확률 2/3로 함정이다. 함정의 낌새는 스킬로 판정가능하나, 스킬레벨이 낮아 확률 1/4로 판정이 잘못된다.  
몬스터를 쓰러뜨리고 보물 상자에 스킬을 썼는데 '함정의 낌새가 없다'는 판정이 나왔을 때 실제로 보물 상자가 함정일 확률'은 얼마인가?
$$
P(X=함정있음) = \frac{2}{3} \\
P(Y=낌새없음,X=함정있음) = \frac{1}{4} \times \frac{2}{3} = \frac{1}{6} \\
P(Y=낌새있음,X=함정없음) = \frac{3}{4} \times \frac{1}{3} = \frac{1}{4} \\
P(Y=낌새없음) = P(Y=낌새없음,X=함정있음)+P(Y=낌새있음,X=함정없음)=\frac{1}{6} + \frac{1}{4}=\frac{5}{12} \\
P(X=함정있음|Y=낌새없음)=\frac{P(X=함정있음,Y=낌새없음)}{P(Y=낌새없음)}\\ = \frac{P(Y=낌새없음,X=함정있음)}{P(Y=낌새없음)}=\frac{\frac{1}{4}}{\frac{5}{12}}=\frac{3}{5}
$$




<h4>ex2)</h4>

Q. 방패를 골랐을 때 1/2 확률로 보통, 1/3 확률로 상급, 1/6로 특제이다. 방패별 성능은 다음과 같다.

- 보통 방패는 1/18 확률로 몬스터의 공격을 피한다.
- 상급 방패는 1/6 확률로 몬스터의 공격을 피한다.
- 특제 방패는 1/3 확률로 몬스터의 공격을 피한다.



1.주운 방패를 장비했을 때 몬스터의 공격을 피할 확률은?
$$
P(Y=피함)=P(Y=피함,X=보통)+P(Y=피함,X=상급)+{P(Y=피함,X=특제)}\\
=\frac{1}{18} \times \frac{1}{2}+\frac{1}{6} \times \frac{1}{3}+\frac{1}{3} \times \frac{1}{6}=\frac{5}{36}
$$
2.주운 방패를 장비하고  몬스터의 공격을 받았는데 공격을 피했다. 이때 방패가 특제일 확률은?
$$
P(X=특제|Y=피함)=\frac{P(X=특제,Y=피함)}{P(Y=피함)}=\frac{\frac{1}{18}}{\frac{5}{36}}=\frac{2}{5}
$$


위의 예제들로 부터 결과로부터 원인을 구하는 방법을 공식화 할 수 있다. X를 원인, Y를 결과라고 했을 때 다음이 성립한다.
$$
P(X=목표원인|Y=결과)=\frac{P(X=목표원인,Y=결과)}{\sum_{원인}P(X=원인,Y=결과)}
$$
